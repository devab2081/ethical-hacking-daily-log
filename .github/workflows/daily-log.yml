name: Daily Ethical Hacking Log

on:
  schedule:
    - cron: "30 18 * * *"   # 12:00 AM IST
  workflow_dispatch:

permissions:
  contents: write

jobs:
  create-daily-log:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Create daily log folder
        run: |
          DAY_COUNT=$(ls -d Day-* 2>/dev/null | wc -l)
          NEXT_DAY=$((DAY_COUNT + 1))
          FOLDER="Day-$(printf "%02d" $NEXT_DAY)"

          if [ ! -d "$FOLDER" ]; then
            mkdir "$FOLDER"

            echo "# ðŸ“˜ Day $NEXT_DAY â€“ Ethical Hacking Learning Log" > "$FOLDER/README.md"
            echo "" >> "$FOLDER/README.md"
            echo "## ðŸ“… Date" >> "$FOLDER/README.md"
            echo "$(date +"%d-%m-%Y")" >> "$FOLDER/README.md"
            echo "" >> "$FOLDER/README.md"
            echo "## ðŸ” Topics Learned" >> "$FOLDER/README.md"
            echo "-" >> "$FOLDER/README.md"
            echo "" >> "$FOLDER/README.md"
            echo "## ðŸ›  Tools / Platforms Used" >> "$FOLDER/README.md"
            echo "-" >> "$FOLDER/README.md"
            echo "" >> "$FOLDER/README.md"
            echo "## ðŸ§  My Understanding" >> "$FOLDER/README.md"
            echo "-" >> "$FOLDER/README.md"
            echo "" >> "$FOLDER/README.md"
            echo "## ðŸ”‘ Key Takeaways" >> "$FOLDER/README.md"
            echo "-" >> "$FOLDER/README.md"
            echo "" >> "$FOLDER/README.md"
            echo "## âœ… Status" >> "$FOLDER/README.md"
            echo "â³ In Progress" >> "$FOLDER/README.md"

            git config user.name "github-actions[bot]"
            git config user.email "github-actions[bot]@users.noreply.github.com"
            git add "$FOLDER/README.md"
            git commit -m "Day $NEXT_DAY: create learning log template"
            git push
          else
            echo "Day folder already exists. No action taken."
          fi
